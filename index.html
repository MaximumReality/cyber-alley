<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Maximum Reality: Cyber Alley</title>
    <style>
        body {
            margin: 0;
            background: #000;
            overflow: hidden;
            font-family: 'Courier New', Courier, monospace;
        }
        #gameCanvas {
            display: block;
            width: 100vw;
            height: 100vh;
            image-rendering: pixelated; /* Keeps that 8-bit crispness */
            background: linear-gradient(to bottom, #2d004b, #8a2be2, #ff00ff);
        }
        .ui-layer {
            position: absolute;
            top: 20px;
            width: 100%;
            text-align: center;
            color: #0ff;
            text-shadow: 0 0 10px #0ff;
            pointer-events: none;
        }
    </style>
</head>
<body>

    <div class="ui-layer">
        <div id="score">SCORE: 000000</div>
        <div id="status">SYSTEMS ONLINE</div>
    </div>

    <canvas id="gameCanvas"></canvas>

<script>
    const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

// --- Configuration ---
const BASE_URL = "https://maximumreality.github.io/cyber-alley/";
let gameSpeed = 5;
let frame = 0;
let isJumping = false;
let jumpHeight = 0;
const gravity = 1.5;
let yVelocity = 0;

class Player {
    constructor(name, x, yOffset, sprites) {
        this.name = name;
        this.x = x;
        this.baseYOffset = yOffset; // Height from bottom
        this.sprites = sprites.map(file => {
            const img = new Image();
            img.src = BASE_URL + file;
            return img;
        });
        this.frameIndex = 0;
    }

    draw() {
        // Simple run animation toggle
        if (frame % 8 === 0) {
            this.frameIndex = (this.frameIndex + 1) % this.sprites.length;
        }
        
        const currentImg = this.sprites[this.frameIndex];
        // Dynamic Y position based on global jumpHeight
        const drawY = (canvas.height - this.baseYOffset) - jumpHeight;

        if (currentImg.complete) {
            ctx.drawImage(currentImg, this.x, drawY, 80, 80); 
        }
    }
}

// --- Initialize the Trio ---
const lori = new Player("lori", 50, 180, ['lori-run.png', 'lori-run2.png']);
const azul = new Player("azul", 140, 170, ['azul-run.png', 'azul-run2.png']);
const mochkil = new Player("mochkil", 230, 140, ['mochkil-idle.png', 'mochkil-cheese.png']);

// --- Controls ---
const handleJump = () => {
    if (!isJumping) {
        isJumping = true;
        yVelocity = -20; // Initial pop up
    }
};

window.addEventListener('touchstart', handleJump);
window.addEventListener('mousedown', handleJump);

function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // 1. Jump Physics
    if (isJumping) {
        jumpHeight -= yVelocity;
        yVelocity += gravity;
        if (jumpHeight <= 0) {
            jumpHeight = 0;
            isJumping = false;
        }
    }

    // 2. Cyber Alley Floor (Scrolling)
    ctx.strokeStyle = "#ff00ff";
    ctx.lineWidth = 2;
    for(let i = 0; i < 8; i++) {
        let lineY = (canvas.height - 100) + (i * 25) + (frame % 25);
        ctx.beginPath();
        ctx.moveTo(0, lineY);
        ctx.lineTo(canvas.width, lineY);
        ctx.stroke();
    }

    // 3. Draw the Team
    lori.draw();
    azul.draw();
    mochkil.draw();

    frame++;
    requestAnimationFrame(animate);
}

animate();

</script>
</body>
</html>
